(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5368],{36326:function(t,e,r){"use strict";r.d(e,{Ih:function(){return getEventModelName},CG:function(){return getGenerateActionName},lM:function(){return useAirbridge}});var a=r(43621),n=r(21084);let useAirbridge=()=>({sendAirbridgeEvent:(t,e)=>{let r={...e,customAttributes:{...null==e?void 0:e.customAttributes,__w_id:(0,a.ej)("__w_id")}};n.Z.events.send(t,r)}}),o={"GPT3.5":"gpt3.5",GPT4:"gpt4","GPT3.5_16K":"gpt-3.5-16k",PALM2:"palm2",GPT4T:"gpt4-turbo",GPT4V:"gpt4-vision","CLAUDE2.1":"claude-2.1",CLAUDE_INSTANT:"claude-instant",WRTN_SEARCH:"wrtn-search",DALLE3:"dalle3"},i={"GPT3.5":"gpt3.5",GPT4:"gpt4","GPT3.5_16K":"gpt16k",PALM2:"palm2",GPT4T:"gpt4_turbo",GPT4V:"gpt4_vision","CLAUDE2.1":"claude_21",CLAUDE_INSTANT:"claude_instant",WRTN_SEARCH:"wrtn_search",DALLE3:"dalle3"},getEventModelName=t=>o[t],getGenerateActionName=t=>i[t]},11894:function(t,e,r){"use strict";r.d(e,{P4:function(){return createChat},F:function(){return deleteChatList},Ag:function(){return getChatList},yL:function(){return getChatListKey},Pn:function(){return isChatListResponse},a4:function(){return updateChat},c9:function(){return useChatList_useChatList},hY:function(){return useChatListMutation}});var a=r(42386),n=r(84631),o=r(43621);let defaultChatUrl=t=>t?"/guest-chat":"/chat-room",getChatListKey=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,o=defaultChatUrl(r);if(e&&!e.nextCursor)return null;let i={type:"model",limit:n},s=r?{...i,cursorId:null==e?void 0:e.nextCursor}:{...i,cursor:null==e?void 0:e.nextCursor};return(0,a.f)(o,s)},getChatList=t=>n.Np.William.get(t,{headers:{"x-wrtn-id":(0,o.ej)(o.Mv.__W_ID)}}),createChat=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return n.Np.William.post(defaultChatUrl(e),{unitId:t,type:"model",headers:{"x-wrtn-id":(0,o.ej)(o.Mv.__W_ID)}})},updateChat=function(t,e){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n.Np.William.put("".concat(r?"/guest-chat":"/chat-room","/").concat(t),{topic:e})},deleteChatList=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?n.Np.William.delete("/guest-chat/".concat(t[0])):n.Np.William.put("/chat-room/delete",{chatIds:t})},getMyChatList=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model",e=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;return n.Np.William.get("/chat-room",{params:{type:t,cursor:e,limit:r}})},getMyCharacterChatList=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return n.Np.BE.get("/chat",{params:{type:t}})},getMyGuestChatList=(t,e)=>n.Np.William.get("/guest-chat",{params:{cursorId:t,limit:e||100},headers:{"x-wrtn-id":(0,o.ej)(o.Mv.__W_ID)}}),createChatV2=t=>n.Np.William.post("/chat-room",{unitId:t.unitId,type:t.type}),createOldChat=t=>n.Np.BE.post("/chat",{unitId:null==t?void 0:t.unitId,type:t.type}),createGuestChat=t=>n.Np.William.post("/guest-chat",{unitId:t.unitId,type:t.type},{headers:{"x-wrtn-id":(0,o.ej)(o.Mv.__W_ID)}}),updateOldChat=t=>n.Np.BE.put("/chat/".concat(t.chatId),{topic:t.topic}),updateChatV2=t=>n.Np.William.put("/chat-room/".concat(t.chatId),{topic:t.topic}),deleteChats=t=>n.Np.BE.put("/api/v2/chat/delete",{chatIds:t}),deleteChatsV2=t=>n.Np.William.put("/chat-room/delete",{chatIds:t});var i=r(44194),s=r(92120),u=r(77095);let isChatListResponse=t=>null!=t&&"object"==typeof t&&"chats"in t&&"nextCursor"in t,useChatList_useChatList=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model",{user:e,isLoading:r}=(0,u.aF)(),api=async(t,r,a)=>{if(e){if("model"!==t)return getMyCharacterChatList(t);{let e=await getMyChatList(t,r,a);return e}}let n=await getMyGuestChatList(r,a);return{chats:n.list,nextCursor:n.nextCursor}},{data:a,isLoading:n,mutate:o}=(0,s.dH)(r?null:e?"/".concat(t):"/guest-chat",()=>api(t),{revalidateOnFocus:!1}),c=(0,i.useMemo)(()=>isChatListResponse(a)?a.chats:Array.isArray(a)?a:[],[a]),l=(0,i.useCallback)(()=>{isChatListResponse(a)&&a.nextCursor&&o(async e=>{if(isChatListResponse(e)){let r=await api(t,a.nextCursor||void 0);if(isChatListResponse(r))return{chats:[...e.chats,...r.chats],nextCursor:r.nextCursor}}return e},!1)},[a,o,t]),d=(0,i.useMemo)(()=>!!isChatListResponse(a)&&null!==a.nextCursor,[a]);return{chatList:null!=c?c:[],loading:n,refetch:o,loadMore:l,hasMore:d}};var c=r(29050);let useChatListMutation=t=>{let{user:e}=(0,u.aF)(),{refetch:r}=useChatList_useChatList(t),{mutate:a}=(0,s.kY)(),createChatMutation=async a=>{let n;return n=e?"character"===t?await createOldChat(a):await createChatV2(a):await createGuestChat({unitId:a.unitId,type:"model"}),r(),n},deleteChatsMutation=async a=>{e?"model"===t?await deleteChatsV2(a):await deleteChats(a):await (0,c.uy)(a[0]),await r()},updateChatMutation=async n=>{e?"model"===t?await updateChatV2(n):await updateOldChat(n):await (0,c.Wh)(n),await r(),await a("/chat/".concat(n.chatId))};return{createChatMutation,deleteChatsMutation,updateChatMutation,refetch:r}};r(44684)},50129:function(t,e,r){"use strict";r.d(e,{getModelName:function(){return n.$}});var a=r(57834);r.o(a,"ChatMode")&&r.d(e,{ChatMode:function(){return a.ChatMode}}),r.o(a,"ChatModel")&&r.d(e,{ChatModel:function(){return a.ChatModel}}),r.o(a,"GenerateAPIError")&&r.d(e,{GenerateAPIError:function(){return a.GenerateAPIError}}),r.o(a,"GenerateError")&&r.d(e,{GenerateError:function(){return a.GenerateError}}),r.o(a,"GenerateSyntaxError")&&r.d(e,{GenerateSyntaxError:function(){return a.GenerateSyntaxError}}),r.o(a,"StreamExceptionError")&&r.d(e,{StreamExceptionError:function(){return a.StreamExceptionError}}),r.o(a,"StreamIdleTimeoutError")&&r.d(e,{StreamIdleTimeoutError:function(){return a.StreamIdleTimeoutError}}),r.o(a,"StreamMessageError")&&r.d(e,{StreamMessageError:function(){return a.StreamMessageError}}),r.o(a,"getMaxTokenConstraints")&&r.d(e,{getMaxTokenConstraints:function(){return a.getMaxTokenConstraints}}),r.o(a,"getModelName")&&r.d(e,{getModelName:function(){return a.getModelName}}),r.o(a,"isAdSearchResult")&&r.d(e,{isAdSearchResult:function(){return a.isAdSearchResult}}),r.o(a,"isImageGenerateInput")&&r.d(e,{isImageGenerateInput:function(){return a.isImageGenerateInput}});var n=r(36608)},36608:function(t,e,r){"use strict";r.d(e,{$:function(){return getModelName}});let a={"gpt3.5":"GPT-3.5",gpt4:"GPT-4","gpt3.5_16k":"GPT-3.5-16K",palm2:"PaLM2",gpt4v:"GPT-4 Turbo",gpt4t:"GPT-4 Boost",claude_instant:"Claude Instant","claude2.1":"Claude 2.1",wrtn_search:"WRTN Search",fast_ai_search:"Fast Ai Search",sdxl:"SDXL",sdxl_jp:"SDXL_JP",dalle3:"DALL\xb7E 3"},getModelName=t=>a[t]},57834:function(t,e,r){"use strict";var a=r(2617);r.o(a,"ChatMode")&&r.d(e,{ChatMode:function(){return a.ChatMode}}),r.o(a,"ChatModel")&&r.d(e,{ChatModel:function(){return a.ChatModel}}),r.o(a,"GenerateAPIError")&&r.d(e,{GenerateAPIError:function(){return a.GenerateAPIError}}),r.o(a,"GenerateError")&&r.d(e,{GenerateError:function(){return a.GenerateError}}),r.o(a,"GenerateSyntaxError")&&r.d(e,{GenerateSyntaxError:function(){return a.GenerateSyntaxError}}),r.o(a,"StreamExceptionError")&&r.d(e,{StreamExceptionError:function(){return a.StreamExceptionError}}),r.o(a,"StreamIdleTimeoutError")&&r.d(e,{StreamIdleTimeoutError:function(){return a.StreamIdleTimeoutError}}),r.o(a,"StreamMessageError")&&r.d(e,{StreamMessageError:function(){return a.StreamMessageError}}),r.o(a,"getMaxTokenConstraints")&&r.d(e,{getMaxTokenConstraints:function(){return a.getMaxTokenConstraints}}),r.o(a,"getModelName")&&r.d(e,{getModelName:function(){return a.getModelName}}),r.o(a,"isAdSearchResult")&&r.d(e,{isAdSearchResult:function(){return a.isAdSearchResult}}),r.o(a,"isImageGenerateInput")&&r.d(e,{isImageGenerateInput:function(){return a.isImageGenerateInput}})},29050:function(t,e,r){"use strict";r.d(e,{xF:function(){return createAssistantMessageTemplate},uy:function(){return deleteGuestChat},U7:function(){return markStreamPerformance},Wh:function(){return updateGuestChatTopic},cG:function(){return useCheckMaxToken}}),r(12027);var a=r(84631);r(3628);var n=r(43621);let updateGuestChatTopic=t=>{let{chatId:e,topic:r}=t;return a.Np.William.put("/guest-chat/".concat(e),{topic:r},{headers:{"x-wrtn-id":(0,n.ej)(n.Mv.__W_ID)}})},deleteGuestChat=t=>a.Np.William.delete("/guest-chat/".concat(t),{headers:{"x-wrtn-id":(0,n.ej)(n.Mv.__W_ID)}});r(44194),r(36326);var o=r(50129);r(66001);var i=r(34715);r(77095);var s=r(27335),u=r(9628);let c={login:"use_generate_chat",non_login:"use_non_login_user_generate_chat"},useCheckMaxToken=t=>{let{trackEvent:e}=(0,i.Ke)(),{tokenize:r}={tokenize:t=>t.length},a=(0,u.T_)();return{checkMaxToken:(n,i,u)=>(0,o.getMaxTokenConstraints)(n.message,n.model)<=r(n.message)&&(s.Am.alert(a("chat.".concat(c[t],".max_token_error"))),i&&i(n.message),e("expose_max_token_fail_modal",{message:n.message,chat_id:u,model_name:n.model.toUpperCase()}),!0)}},createAssistantMessageTemplate=t=>{let{reroll:e=!1,content:r="",isTemp:a=!1,chipList:n=[],uuid:o="",id:i,chatId:s,isGenerateImage:u,isSuperMode:c}=t;return{__v:0,_id:i||"NEW_ASSISTANT_MESSAGE_ID",content:r,createdAt:"",disliked:!1,liked:!1,role:"assistant",updatedAt:"",type:"Message",toolId:"",loading:!e,model:"",isTemp:a,dynamicChips:n,uuid:o,chatId:s,image:u?{imageUrls:[],_id:"SKELETON"}:void 0,isSuperMode:c}};var l=r(1972);let markStreamPerformance=(t,e)=>{try{var r;performance.mark("endTask"),performance.measure("measureTask","startTask","endTask");let a=performance.getEntriesByName("measureTask"),n=null==a?void 0:null===(r=a[0])||void 0===r?void 0:r.duration;n&&((0,l.K)("info","발화 시작 - 생성 대기 문구 레이턴시 측정",{latency:n,model:e,isChocoChip:t.isChocoChip}),performance.clearMarks("startTask"),performance.clearMarks("endTask"),performance.clearMeasures("measureTask"))}catch(t){}}},34776:function(){}}]);